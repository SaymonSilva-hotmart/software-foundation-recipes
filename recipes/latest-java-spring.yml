type: specs.openrewrite.org/v1beta/recipe
name: com.hotmart.recipes.LatestJavaSpringVersion
displayName: Upgrade Maven dependency version example
recipeList:
  - org.openrewrite.java.migrate.UpgradeToJava21
  - org.openrewrite.java.spring.boot3.UpgradeSpringBoot_3_3
  - org.openrewrite.maven.UpgradeDependencyVersion:
      groupId: com.hotmart
      artifactId: hot-security-spring-boot-starter
      newVersion: 3.1.15
  - org.openrewrite.maven.UpgradeDependencyVersion:
      groupId: com.hotmart.datahub
      artifactId: datahub-client-api
      newVersion: 4.2.0
  - org.openrewrite.maven.UpgradeDependencyVersion:
      groupId: com.hotmart.observability
      artifactId: hot-observability-spring-boot-starter
      newVersion: 2.0.4
  - org.openrewrite.maven.UpgradeDependencyVersion:
      groupId: com.hotmart
      artifactId: vault
      newVersion: 1.0.1
  - org.openrewrite.maven.UpgradeDependencyVersion:
      groupId: com.hotmart
      artifactId: hot-spring-start-accounts-client
      newVersion: 5.0.34
  - org.openrewrite.maven.UpgradeDependencyVersion:
      groupId: com.hotmart.backoffice
      artifactId: audit-agent
      newVersion: 3.1.0-java21
  - org.openrewrite.java.dependencies.ChangeDependency:
      oldGroupId: com.hotmart.acl
      oldArtifactId: acl-auth-client-spring-boot-starter
      newGroupId: com.hotmart.acl
      newArtifactId: acl-auth-client-spring-boot-v3-starter
      newVersion: 1.7.3
  - org.openrewrite.maven.UpgradeDependencyVersion:
      groupId: com.hotmart.acl
      artifactId: acl-auth-client-spring-boot-v3-starter
      newVersion: 1.7.3
  - org.openrewrite.maven.UpgradeDependencyVersion:
      groupId: com.hotmart.lib
      artifactId: lib-sap-integration
      newVersion: 4.0.1
  - org.openrewrite.maven.UpgradeDependencyVersion:
      groupId: com.hotmart
      artifactId: lib-sap-commons
      newVersion: 2.0.1
  - org.openrewrite.maven.UpgradePluginVersion:
      groupId: org.jacoco
      artifactId: jacoco-maven-plugin
      newVersion: 0.8.11
  - org.openrewrite.maven.UpgradeDependencyVersion:
      groupId: org.sonarsource.scanner.maven
      artifactId: sonar-maven-plugin
      newVersion: 3.10.0.2594
  - org.openrewrite.maven.UpgradeDependencyVersion:
      groupId: io.awspring.cloud
      artifactId: spring-cloud-aws-dependencies
      newVersion: 3.1.0
  - org.openrewrite.maven.UpgradeDependencyVersion:
      groupId: org.json
      artifactId: json
      newVersion: 20231013
  - org.openrewrite.maven.UpgradeDependencyVersion:
      groupId: com.newrelic.agent.java
      artifactId: newrelic-api
      newVersion: 8.9.1
  - org.openrewrite.maven.UpgradeDependencyVersion:
      groupId: org.junit.jupiter
      artifactId: junit-jupiter-engine
      newVersion: 5.10.1
  - org.openrewrite.maven.AddDependency:
      groupId: com.hotmart.observability
      artifactId: hot-observability-spring-boot-starter
      version: 2.0.1
      type: pom
  - org.openrewrite.maven.AddDependency:
      groupId: com.hotmart.security.http
      artifactId: xss-protection-spring-boot-starter
      version: 2.1.2
  - org.openrewrite.maven.ChangeDependencyGroupIdAndArtifactId:
      oldGroupId: io.awspring.cloud
      oldArtifactId: spring-cloud-starter-aws-messaging
      newGroupId: io.awspring.cloud
      newArtifactId: spring-cloud-aws-starter-sqs
  - org.openrewrite.maven.ChangeDependencyGroupIdAndArtifactId:
      oldGroupId: io.awspring.cloud
      oldArtifactId: spring-cloud-starter-aws
      newGroupId: io.awspring.cloud
      newArtifactId: spring-cloud-aws-starter
  - org.openrewrite.maven.ChangeDependencyGroupIdAndArtifactId:
      oldGroupId: com.amazonaws
      oldArtifactId: aws-java-sdk-athena
      newGroupId: software.amazon.awssdk
      newArtifactId: athena
      newVersion: 2.24.5
  - org.openrewrite.maven.ChangeDependencyGroupIdAndArtifactId:
      oldGroupId: org.springdoc
      oldArtifactId: springdoc-openapi-ui
      newGroupId: org.springdoc
      newArtifactId: springdoc-openapi-starter-webmvc-ui
      newVersion: 2.3.0
  - org.openrewrite.maven.RemoveDependency:
      groupId: org.apache.httpcomponents
      artifactId: httpclient
  - org.openrewrite.maven.RemoveDependency:
      groupId: org.mockito
      artifactId: mockito-inline
  - org.openrewrite.maven.RemoveDependency:
      groupId: io.springfox
      artifactId: springfox-swagger2
  - org.openrewrite.maven.RemoveDependency:
      groupId: io.springfox
      artifactId: springfox-swagger-ui
  - org.openrewrite.maven.RemoveDependency:
      groupId: com.hotmart
      artifactId: hot-log-spring-boot-starter
  - org.openrewrite.maven.RemoveManagedDependency:
      groupId: org.testcontainers
      artifactId: testcontainers-bom
  - org.openrewrite.maven.RemoveManagedDependency:
      groupId: org.springdoc
      artifactId: springdoc-openapi-security
  - org.openrewrite.java.RemoveAnnotationAttribute:
      annotationType: io.awspring.cloud.messaging.listener.annotation.SqsListener
      attributeName: deletionPolicy
  - org.openrewrite.text.FindAndReplace:
      find: io.awspring.cloud.messaging.listener.annotation.SqsListener
      replace: io.awspring.cloud.sqs.annotation.SqsListener
      filePattern: '**/*.java'
  - org.openrewrite.text.FindAndReplace:
      find: 'Acknowledgment acknowledgment'
      replace: 'Acknowledgement acknowledgment'
      filePattern: '**/*.java'
  - org.openrewrite.text.FindAndReplace:
      find: 'Acknowledgment.class'
      replace: 'Acknowledgement.class'
      filePattern: '**/*.java'
  - org.openrewrite.text.FindAndReplace:
      find: io.awspring.cloud.messaging.listener.Acknowledgment
      replace: io.awspring.cloud.sqs.listener.acknowledgement.Acknowledgement
      filePattern: '**/*.java'
  - org.openrewrite.maven.ChangeManagedDependencyGroupIdAndArtifactId:
      oldGroupId: com.github.cloudyrock.mongock
      oldArtifactId: mongock-bom
      newGroupId: io.mongock
      newArtifactId: mongock-bom
      newVersion: 5.4.4
  - org.openrewrite.maven.ChangeDependencyGroupIdAndArtifactId:
      oldGroupId: com.github.cloudyrock.mongock
      oldArtifactId: mongock-spring-v5
      newGroupId: io.mongock
      newArtifactId: mongock-springboot-v3
  - org.openrewrite.maven.ChangeDependencyGroupIdAndArtifactId:
      oldGroupId: com.github.cloudyrock.mongock
      oldArtifactId: mongodb-springdata-v3-driver
      newGroupId: io.mongock
      newArtifactId: mongodb-springdata-v4-driver
  - org.openrewrite.text.FindAndReplace:
      find: com.github.cloudyrock.spring.v5.EnableMongock
      replace: io.mongock.runner.springboot.EnableMongock
      filePattern: '**/*.java'
  - org.openrewrite.text.FindAndReplace:
      find: com.github.cloudyrock.mongock.driver.mongodb.springdata.v3.decorator.impl.MongockTemplate
      replace: com.github.cloudyrock.mongock.driver.mongodb.springdata.v4.decorator.impl.MongockTemplate
      filePattern: '**/*.java'
  - org.openrewrite.text.FindAndReplace:
      find: change-logs-scan-package
      replace: migration-scan-package
      filePattern: '**/application.yml'
  - org.openrewrite.text.FindAndReplace:
      find: '@Header(name = "LogicalResourceId")'
      replace: '@Header(name = "Sqs_QueueName")'
      filePattern: '**/*.java'
  - org.openrewrite.text.FindAndReplace:
      find: '@Header(name = "ApproximateReceiveCount")'
      replace: '@Header(name = "Sqs_Msa_ApproximateReceiveCount")'
      filePattern: '**/*.java'
  - org.openrewrite.text.FindAndReplace:
      find: '.*io.awspring.cloud.messaging.listener.SqsMessageDeletionPolicy.*'
      replace: ''
      regex: true
      filePattern: '**/*.java'
  - org.openrewrite.maven.RemoveExclusion:
      groupId: org.springframework.boot
      artifactId: spring-boot-starter-test
      exclusionGroupId: org.junit.jupiter
      exclusionArtifactId: '*'
  - org.openrewrite.maven.RemoveExclusion:
      groupId: org.springframework.security
      artifactId: spring-security-test
      exclusionGroupId: org.junit.jupiter
      exclusionArtifactId: '*'
  - org.openrewrite.maven.RemoveExclusion:
      groupId: org.springframework.cloud
      artifactId: spring-cloud-starter-contract-stub-runner
      exclusionGroupId: org.junit.jupiter
      exclusionArtifactId: '*'
  - org.openrewrite.maven.RemoveExclusion:
      groupId: com.hotmart.acl
      artifactId: acl-auth-client-spring-boot-v3-starter
      exclusionGroupId: org.junit.jupiter
      exclusionArtifactId: '*'
  - org.openrewrite.maven.RemoveExclusion:
      groupId: org.springframework.boot
      artifactId: spring-boot-starter-test
      exclusionGroupId: org.mockito
      exclusionArtifactId: '*'
  - org.openrewrite.maven.RemoveExclusion:
      groupId: org.springframework.security
      artifactId: spring-security-test
      exclusionGroupId: org.mockito
      exclusionArtifactId: '*'
  - org.openrewrite.maven.RemoveExclusion:
      groupId: org.springframework.cloud
      artifactId: spring-cloud-starter-contract-stub-runner
      exclusionGroupId: org.mockito
      exclusionArtifactId: '*'
  - org.openrewrite.maven.RemoveExclusion:
      groupId: com.hotmart.acl
      artifactId: acl-auth-client-spring-boot-v3-starter
      exclusionGroupId: org.mockito
      exclusionArtifactId: '*'
  - org.openrewrite.maven.RemoveExclusion:
      groupId: org.testcontainers
      artifactId: '*'
      exclusionGroupId: junit
      exclusionArtifactId: junit
  - org.openrewrite.maven.UpgradeDependencyVersion:
      groupId: io.projectreactor
      artifactId: reactor-core
      newVersion: 3.6.3
  - org.openrewrite.java.dependencies.ChangeDependency:
      oldGroupId: io.hypersistence
      oldArtifactId: 'hypersistence-utils-hibernate-*'
      newGroupId: io.hypersistence
      newArtifactId: hypersistence-utils-hibernate-63
      newVersion: 3.9.0
  - org.openrewrite.java.ReplaceAnnotation:
      annotationPatternToReplace: '@org.hibernate.annotations.Type(type = "json")'
      annotationTemplateToInsert: '@org.hibernate.annotations.Type(JsonType.class)'
  - org.openrewrite.java.RemoveAnnotation:
      annotationPattern: '@org.hibernate.annotations.TypeDefs(..)'
  - org.openrewrite.text.FindAndReplace:
      find: '.*org.hibernate.annotations.TypeDef.*'
      replace: ''
      regex: true
      filePattern: '**/*.java'
  - org.openrewrite.text.FindAndReplace:
      find: '.*org.hibernate.annotations.TypeDefs.*'
      replace: ''
      regex: true
      filePattern: '**/*.java'
  - org.openrewrite.maven.UpgradeDependencyVersion:
      groupId: org.redisson
      artifactId: redisson-spring-boot-starter
      newVersion: 3.39.0
  - org.openrewrite.maven.RemoveExclusion:
      groupId: org.redisson
      artifactId: redisson-spring-boot-starter
      exclusionGroupId: org.redisson
      exclusionArtifactId: 'redisson-spring-data-*'
  - org.openrewrite.maven.RemoveDependency:
      groupId: org.redisson
      artifactId: 'redisson-spring-data-*'
  - org.openrewrite.maven.RemoveManagedDependency:
      groupId: org.redisson
      artifactId: 'redisson-spring-data-*'
  - org.openrewrite.maven.RemoveDuplicateDependencies
  - org.openrewrite.java.RemoveUnusedImports
  - org.openrewrite.java.OrderImports
  - org.openrewrite.xml.AddCommentToXmlTag:
      xPath: /project/parent
      commentText: Update project using rewrite recipe version 1.0.1